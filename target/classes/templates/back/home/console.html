

<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org" xmlns:shiro="http://www.w3.org/1999/xhtml">
<head>
  <meta charset="utf-8">
  <title>layuiAdmin 控制台主页一</title>
  <meta name="renderer" content="webkit">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=0">
  <link rel="stylesheet" href="../../layuiadmin/layui/css/layui.css" media="all">
  <link rel="stylesheet" href="../../layuiadmin/style/admin.css" media="all">
  <!-- 引入 echarts.js -->
  <script src="https://cdn.staticfile.org/echarts/4.3.0/echarts.min.js"></script>
  <script src="https://cdn.staticfile.org/jquery/1.10.2/jquery.min.js"></script>
</head>
<body>
  
  <div class="layui-fluid">
    <div class="layui-row layui-col-space15">
      <div class="layui-col-md12">
        <div class="layui-row layui-col-space15">
          <div class="layui-col-md5">
            <div class="layui-card">
              <div class="layui-card-header">快捷方式</div>
              <div class="layui-card-body">
                
                <div class="layui-carousel layadmin-carousel layadmin-shortcut">
                  <div carousel-item>
                    <ul class="layui-row layui-col-space10">
                      <li class="layui-col-xs3" shiro:hasPermission="task:zhcprwfb">
                        <a lay-href="/zhcp/admin/toZhcpList">
                          <i class="layui-icon layui-icon-release"></i>
                          <cite>综测任务</cite>
                        </a>
                      </li>
                      <li class="layui-col-xs3" shiro:hasPermission="task:zhcpsjlb">
                        <a lay-href="/zhcp/admin/toZhcpData">
                          <i class="layui-icon layui-icon-template-1"></i>
                          <cite>综测数据</cite>
                        </a>
                      </li>
                      <li class="layui-col-xs3" shiro:hasPermission="task:zhcpsjhz">
                        <a lay-href="/zhcp/admin/toZhcpSummaryOfAdmin">
                          <i class="layui-icon layui-icon-chart"></i>
                          <cite>综测汇总</cite>
                        </a>
                      </li>
                      <li class="layui-col-xs3" shiro:hasPermission="task:bjtz">
                        <a lay-href="/bjrw/admin/inform">
                          <i class="layui-icon layui-icon-chat"></i>
                          <cite>班级通知</cite>
                        </a>
                      </li>
                      <li class="layui-col-xs3" shiro:hasPermission="task:bbtxrwfb">
                        <a lay-href="/bbtx/admin/toBbtxList">
                          <i class="layui-icon layui-icon-file"></i>
                          <cite>报表任务</cite>
                        </a>
                      </li>
                      <li class="layui-col-xs3" shiro:hasPermission="task:bbtxsjlb">
                        <a lay-href="/bbtx/admin/toBbtxData">
                          <i class="layui-icon layui-icon-table"></i>
                          <cite>报表数据</cite>
                        </a>
                      </li>
                      <li class="layui-col-xs3" shiro:hasPermission="advise:bjjsyj">
                        <a lay-href="/bjlyb/admin/bjjs">
                          <i class="layui-icon layui-icon-form"></i>
                          <cite>班级意见</cite>
                        </a>
                      </li>
                      <li class="layui-col-xs3" shiro:hasPermission="advise:bwgzfk">
                        <a lay-href="/bjlyb/admin/bwgz">
                          <i class="layui-icon layui-icon-survey"></i>
                          <cite>工作反馈</cite>
                        </a>
                      </li>
                    </ul>
                    <ul class="layui-row layui-col-space10">
                      <li class="layui-col-xs3" shiro:hasPermission="advise:bwmydcprwfb">
                        <a lay-href="/bjlyb/admin/bwmydcpList">
                          <i class="layui-icon layui-icon-user"></i>
                          <cite>班委测评</cite>
                        </a>
                      </li>
                      <li class="layui-col-xs3" shiro:hasPermission="advise:bwmydcpsjlb">
                        <a lay-href="/bjlyb/admin/bwmydcpData">
                          <i class="layui-icon layui-icon-table"></i>
                          <cite>班委测评数据</cite>
                        </a>
                      </li>
                      <li class="layui-col-xs3" shiro:hasPermission="xxwh:xsjl">
                        <a lay-href="/xxwh/admin/toStuInfo">
                          <i class="layui-icon layui-icon-tabs"></i>
                          <cite>学生简历</cite>
                        </a>
                      </li>
                      <li class="layui-col-xs3" shiro:hasPermission="xxwh:zmcl">
                        <a lay-href="/xxwh/admin/toEvidenceInfo">
                          <i class="layui-icon layui-icon-picture-fine"></i>
                          <cite>证明材料</cite>
                        </a>
                      </li>
                    </ul>

                    
                  </div>
                </div>
                
              </div>
            </div>
          </div>
          <div class="layui-col-md7">
            <div class="layui-card">
              <div class="layui-card-header">待办事项</div>
              <div class="layui-card-body">

                <div class="layui-carousel layadmin-carousel layadmin-backlog">
                  <div carousel-item>
                    <ul class="layui-row layui-col-space10">
                      <li class="layui-col-xs3" shiro:hasPermission="task:zhcpsjlb">
                        <a lay-href="/zhcp/admin/toZhcpData" class="layadmin-backlog-body">
                          <h3>未提交综测数据</h3>
                          <p><cite>[[${matterList[0]}]]</cite></p>
                        </a>
                      </li>
                      <li class="layui-col-xs3" shiro:hasPermission="task:zhcpsjlb">
                        <a lay-href="/zhcp/admin/toZhcpData" class="layadmin-backlog-body">
                          <h3>已暂存综测数据</h3>
                          <p><cite>[[${matterList[1]}]]</cite></p>
                        </a>
                      </li>
                      <li class="layui-col-xs3" shiro:hasPermission="task:zhcpsjlb">
                        <a lay-href="/zhcp/admin/toZhcpData" class="layadmin-backlog-body">
                          <h3>已完成综测数据</h3>
                          <p><cite>[[${matterList[2]}]]</cite></p>
                        </a>
                      </li>
                      <li class="layui-col-xs3" shiro:hasPermission="task:zhcpsjlb">
                        <a lay-href="/zhcp/admin/toZhcpData" class="layadmin-backlog-body">
                          <h3>待复核综测数据</h3>
                          <p><cite>[[${matterList[3]}]]</cite></p>
                        </a>
                      </li>
                      <li class="layui-col-xs3" shiro:hasPermission="task:zhcpsjlb">
                        <a lay-href="/zhcp/admin/toZhcpData" class="layadmin-backlog-body">
                          <h3>待审核综测数据</h3>
                          <p><cite>[[${matterList[4]}]]</cite></p>
                        </a>
                      </li>
                      <li class="layui-col-xs3" shiro:hasPermission="task:zhcpsjlb">
                        <a lay-href="/zhcp/admin/toZhcpData" class="layadmin-backlog-body">
                          <h3>审核中综测数据</h3>
                          <p><cite>[[${matterList[5]}]]</cite></p>
                        </a>
                      </li>
                      <li class="layui-col-xs3" shiro:hasPermission="task:zhcpsjlb">
                        <a lay-href="/zhcp/admin/toZhcpData" class="layadmin-backlog-body">
                          <h3>已驳回综测数据</h3>
                          <p><cite>[[${matterList[6]}]]</cite></p>
                        </a>
                      </li>
                      <li class="layui-col-xs3" shiro:hasPermission="task:zhcpsjlb">
                        <a lay-href="/zhcp/admin/toZhcpData" class="layadmin-backlog-body">
                          <h3>已过审综测数据</h3>
                          <p><cite>[[${matterList[7]}]]</cite></p>
                        </a>
                      </li>
                    </ul>
                    <ul class="layui-row layui-col-space10">
                      <li class="layui-col-xs3" shiro:hasPermission="task:bbtxsjlb">
                        <a lay-href="/bbtx/admin/toBbtxData" class="layadmin-backlog-body">
                          <h3>未提交报表数据</h3>
                          <p><cite>[[${matterList[8]}]]</cite></p>
                        </a>
                      </li>
                      <li class="layui-col-xs3" shiro:hasPermission="task:bbtxsjlb">
                        <a lay-href="/bbtx/admin/toBbtxData" class="layadmin-backlog-body">
                          <h3>已完成报表数据</h3>
                          <p><cite>[[${matterList[9]}]]</cite></p>
                        </a>
                      </li>
                      <li class="layui-col-xs3" shiro:hasPermission="task:bbtxsjlb">
                        <a lay-href="/bbtx/admin/toBbtxData" class="layadmin-backlog-body">
                          <h3>待审核报表数据</h3>
                          <p><cite>[[${matterList[10]}]]</cite></p>
                        </a>
                      </li>
                      <li class="layui-col-xs3" shiro:hasPermission="task:bbtxsjlb">
                        <a lay-href="/bbtx/admin/toBbtxData" class="layadmin-backlog-body">
                          <h3>已驳回报表数据</h3>
                          <p><cite>[[${matterList[11]}]]</cite></p>
                        </a>
                      </li>
                      <li class="layui-col-xs3" shiro:hasPermission="task:bjtz">
                        <a lay-href="/bjrw/admin/inform" class="layadmin-backlog-body">
                          <h3>已发布班级通知</h3>
                          <p><cite>[[${matterList[12]}]]</cite></p>
                        </a>
                      </li>
                      <li class="layui-col-xs3" shiro:hasPermission="advise:bjjsyj">
                        <a lay-href="/bjlyb/admin/bjjs" class="layadmin-backlog-body">
                          <h3>待回复班级建议</h3>
                          <p><cite>[[${matterList[13]}]]</cite></p>
                        </a>
                      </li>
                      <li class="layui-col-xs3" shiro:hasPermission="advise:bwgzfk">
                        <a lay-href="/bjlyb/admin/bwgz" class="layadmin-backlog-body">
                          <h3>待回复工作反馈</h3>
                          <p><cite>[[${matterList[14]}]]</cite></p>
                        </a>
                      </li>
                      <li class="layui-col-xs3" shiro:hasPermission="advise:bwmydcpsjlb">
                        <a lay-href="/bjlyb/admin/bwmydcpData" class="layadmin-backlog-body">
                          <h3>未完成班委测评</h3>
                          <p><cite>[[${matterList[15]}]]</cite></p>
                        </a>
                      </li>
                    </ul>
                    <ul class="layui-row layui-col-space10">
                      <li class="layui-col-xs3" shiro:hasPermission="xxwh:xsjl">
                        <a lay-href="/xxwh/admin/toStuInfo" class="layadmin-backlog-body">
                          <h3>未提交学生简历</h3>
                          <p><cite>[[${matterList[16]}]]</cite></p>
                        </a>
                      </li>
                      <li class="layui-col-xs3" shiro:hasPermission="xxwh:xsjl">
                        <a lay-href="/xxwh/admin/toStuInfo" class="layadmin-backlog-body">
                          <h3>待审核学生简历</h3>
                          <p><cite>[[${matterList[17]}]]</cite></p>
                        </a>
                      </li>
                      <li class="layui-col-xs3" shiro:hasPermission="xxwh:xsjl">
                        <a lay-href="/xxwh/admin/toStuInfo" class="layadmin-backlog-body">
                          <h3>已驳回学生简历</h3>
                          <p><cite>[[${matterList[18]}]]</cite></p>
                        </a>
                      </li>
                      <li class="layui-col-xs3" shiro:hasPermission="xxwh:xsjl">
                        <a lay-href="/xxwh/admin/toStuInfo" class="layadmin-backlog-body">
                          <h3>已完成学生简历</h3>
                          <p><cite>[[${matterList[19]}]]</cite></p>
                        </a>
                      </li>
                      <li class="layui-col-xs3" shiro:hasPermission="xxwh:zmcl">
                        <a lay-href="/xxwh/admin/toEvidenceInfo" class="layadmin-backlog-body">
                          <h3>未提交证明材料</h3>
                          <p><cite>[[${matterList[20]}]]</cite></p>
                        </a>
                      </li>
                      <li class="layui-col-xs3" shiro:hasPermission="xxwh:zmcl">
                        <a lay-href="/xxwh/admin/toEvidenceInfo" class="layadmin-backlog-body">
                          <h3>待审核证明材料</h3>
                          <p><cite>[[${matterList[21]}]]</cite></p>
                        </a>
                      </li>
                      <li class="layui-col-xs3" shiro:hasPermission="xxwh:zmcl">
                        <a lay-href="/xxwh/admin/toEvidenceInfo" class="layadmin-backlog-body">
                          <h3>已驳回证明材料</h3>
                          <p><cite>[[${matterList[22]}]]</cite></p>
                        </a>
                      </li>
                      <li class="layui-col-xs3" shiro:hasPermission="xxwh:zmcl">
                        <a lay-href="/xxwh/admin/toEvidenceInfo" class="layadmin-backlog-body">
                          <h3>已完成证明材料</h3>
                          <p><cite>[[${matterList[23]}]]</cite></p>
                        </a>
                      </li>
                    </ul>
                  </div>
                </div>
              </div>
            </div>
          </div>



          <div class="layui-col-md12">
            <div class="layui-card">
              <div class="layui-card-header">数据概览</div>
              <div class="layui-card-body" style="height: 330px">

<!--                <div class="layui-carousel layadmin-carousel layadmin-dataview" data-anim="fade" lay-filter="LAY-index-dataview">-->
<!--                  <div carousel-item id="LAY-index-dataview">-->
<!--                    <div><i class="layui-icon layui-icon-loading1 layadmin-loading"></i></div>-->
<!--                    <div></div>-->
<!--                    <div></div>-->
<!--                  </div>-->
<!--                </div>-->

                <div class="layui-carousel layadmin-carousel layadmin-dataview" id="test1" >
                  <div carousel-item>
                    <!-- 为 ECharts 准备一个具备大小（宽高）的 DOM -->
                    <div id="bar" style="height: 300px"></div>
                    <div id="pie" style="height: 300px" th:if="${role ==  3}">dfasd</div>
                  </div>
                </div>

              </div>
            </div>

          </div>
        </div>
      </div>
        

      </div>
      
    </div>
  </div>

  <script src="../../layuiadmin/layui/layui.js?t=1"></script>

  <script type="text/javascript">
    //设置tu的宽度
    var o = document.getElementById("test1");
    var width= o.clientWidth||o.offsetWidth;
    var echart =$("#bar");
    var pieEchart = $("#pie");
    echart.css("width",width+"px");
    pieEchart.css("width",width+"px");

    // 基于准备好的dom，初始化echarts实例
    var myChart = echarts.init(document.getElementById('bar'));
    //数据加载完之前先显示一段简单的loading动画
    myChart.showLoading();
    $.ajax({
      type : "get",
      async : true,            //异步请求（同步请求将会锁住浏览器，用户其他操作必须等待请求完成才可以执行）
      url : "/back/home/bar",    //请求发送到dataActiont处
      dataType : "json",        //返回数据形式为json
      success : function(result) {
        //请求成功时执行该函数内容，result即为服务器返回的json对象
        if (0 == result.code) {
          myChart.hideLoading();    //隐藏加载动画
          var unCommit = result.unCommit
          var toAudit  = result.toAudit
          var rejected  = result.rejected
          var completed  = result.completed
        }
        myChart.setOption({        //加载数据图表
          title: {
            text: '班级任务进度一览表',
          },
          tooltip: {
            trigger: 'axis'
          },
          grid: {
            left: '10%',
            right: '10%',
            bottom: '1%',
            top: '23%',
            containLabel: true
          },
          legend: {
            data: ['未提交', '待审核','已驳回','已完成']
          },
          toolbox: {
            show: true,
            feature: {
              // dataView: {show: true, readOnly: false},
              magicType: {show: true, type: ['line', 'bar']},
              // restore: {show: true},
              saveAsImage: {show: true}
            }
          },
          calculable: true,
          xAxis: [
            {
              type: 'category',
              data: ['综合测评', '报表填写', '学生简历', '证明材料']
            }
          ],
          yAxis: [
            {
              type: 'value'
            }
          ],
          series: [
            {
              name: '未提交',
              type: 'bar',
              data: unCommit,
              width: '20px',
              color: 'rgb(252,118,76)'
            },
            {
              name: '待审核',
              type: 'bar',
              data: toAudit,
              width: '20px',
              color: 'rgb(30,159,255)'
            },
            {
              name: '已驳回',
              type: 'bar',
              data: rejected,
              width: '20px',
              color: 'rgb(255,184,0)'
            },
            {
              name: '已完成',
              type: 'bar',
              data: completed,
              barGap: '0%',
              width: '20px',
              color: 'rgb(0,150,136)'
            }
          ]
        });
      },
      error : function() {
        myChart.hideLoading();
      }
    })//end ajax


    // 基于准备好的dom，初始化echarts实例
    var pieEchart = echarts.init(document.getElementById('pie'));
    //数据加载完之前先显示一段简单的loading动画
    pieEchart.showLoading();
    $.ajax({
      type : "get",
      async : true,            //异步请求（同步请求将会锁住浏览器，用户其他操作必须等待请求完成才可以执行）
      url : "/back/home/pie",    //请求发送到dataActiont处
      dataType : "json",        //返回数据形式为json
      success : function(result) {
        //请求成功时执行该函数内容，result即为服务器返回的json对象
        if (0 == result.code) {
          pieEchart.hideLoading();    //隐藏加载动画
          var position = result.position
          var sum = result.sum
          var list = []

          for (var i=0; i<position.length; i++){
            list[i] = {value: sum[i], name: position[i]}
          }
          console.log(list)
        }
        pieEchart.setOption({        //加载数据图表
          title: {
            text: '班委工作反馈统计',
            left: 'center'
          },
          toolbox: {
            show: true,
            feature: {
              saveAsImage: {show: true}
            }
          },
          tooltip: {
            trigger: 'item'
          },
          grid: {
            left: '10%',
            right: '10%',
            bottom: '1%',
            top: '23%',
            containLabel: true
          },
          legend: {
            orient: 'vertical',
            left: 'left',
          },
          series: [
            {
              // name: '访问来源',
              type: 'pie',
              radius: '50%',
              data: list,
              emphasis: {
                itemStyle: {
                  shadowBlur: 10,
                  shadowOffsetX: 0,
                  shadowColor: 'rgba(0, 0, 0, 0.5)'
                }
              }
            }
          ]
        });
      },
      error : function() {
        pieEchart.hideLoading();
      }
    })//end ajax

  </script>

  <script>
  layui.config({
    base: '../../layuiadmin/' //静态资源所在路径
  }).extend({
    index: 'lib/index' //主入口模块
  }).use(['index', 'console']).use('carousel', function(){
    var carousel = layui.carousel;
    //建造实例
    carousel.render({
      elem: '#test1'
      ,width: '100%' //设置容器宽度
      ,indicator: 'outside'
      ,arrow: 'none'
      ,autoplay: false
      //,anim: 'updown' //切换动画方式
    });
  });
  </script>
</body>
</html>

